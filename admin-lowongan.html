<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Lowongan Kerja - KerjaAja</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/notifications.css">
    <link rel="stylesheet" href="css/admin-notifications.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
   <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <a href="admin-dashboard.html">KerjaAja Admin</a>
            </div>
            <nav class="nav">
                <ul>
                    <!-- Admin Notifications -->
                    <li class="notification-dropdown">
                        <div class="notification-menu" id="adminNotificationMenu">
                            <div class="notification-header">
                                <h4>Notifikasi Admin</h4>
                                <button class="mark-all-read" id="adminMarkAllRead">
                                    <i class="fas fa-check-double"></i>
                                    Tandai Semua Dibaca
                                </button>
                            </div>
                            <div class="notification-list" id="adminNotificationList">
                                <!-- Admin notifications will be populated by JavaScript -->
                            </div>
                            <div class="notification-footer">
                                <a href="admin-notifications.html" id="viewAllAdminNotifications">Lihat Semua Notifikasi</a>
                            </div>
                        </div>
                    </li>

                    <li>
                        <button class="btn btn-primary" id="sendNotificationBtn">
                            <i class="fas fa-paper-plane"></i> Kirim Notifikasi
                        </button>
                    </li>

                    <li><a href="#" id="logoutBtn" class="btn-logout">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Notification Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Send Notification Modal -->
    <div id="sendNotificationModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeSendModal">&times;</span>
            <h2>Kirim Notifikasi</h2>
            <p>Kirim notifikasi ke pengguna platform</p>
            
            <form id="sendNotificationForm">
                <div class="form-group">
                    <label for="notificationType">Jenis Notifikasi</label>
                    <select id="notificationType" required>
                        <option value="">Pilih Jenis</option>
                        <option value="info">Informasi</option>
                        <option value="success">Berhasil</option>
                        <option value="warning">Peringatan</option>
                        <option value="error">Error</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="notificationTarget">Target Penerima</label>
                    <select id="notificationTarget" required>
                        <option value="">Pilih Target</option>
                        <option value="all">Semua Pengguna</option>
                        <option value="active">Pengguna Aktif</option>
                        <option value="training">Peserta Pelatihan</option>
                        <option value="job_seekers">Pencari Kerja</option>
                        <option value="specific">Pengguna Tertentu</option>
                    </select>
                </div>

                <div class="form-group" id="specificUsersGroup" style="display: none;">
                    <label for="specificUsers">Email Pengguna (pisahkan dengan koma)</label>
                    <textarea id="specificUsers" rows="3" placeholder="user1@email.com, user2@email.com"></textarea>
                </div>

                <div class="form-group">
                    <label for="notificationTitle">Judul Notifikasi</label>
                    <input type="text" id="notificationTitle" required placeholder="Masukkan judul notifikasi">
                </div>

                <div class="form-group">
                    <label for="notificationMessage">Pesan</label>
                    <textarea id="notificationMessage" rows="4" required placeholder="Masukkan pesan notifikasi"></textarea>
                </div>

                <div class="form-group">
                    <label for="notificationAction">Action URL (opsional)</label>
                    <input type="url" id="notificationAction" placeholder="https://example.com">
                </div>

                <div class="form-group">
                    <label for="scheduleNotification">
                        <input type="checkbox" id="scheduleNotification"> Jadwalkan Notifikasi
                    </label>
                </div>

                <div class="form-group" id="scheduleGroup" style="display: none;">
                    <label for="scheduleDateTime">Tanggal & Waktu</label>
                    <input type="datetime-local" id="scheduleDateTime">
                </div>

                <div class="modal-buttons">
                    <button type="button" id="cancelSendNotification" class="btn btn-outline">Batal</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i> Kirim Notifikasi
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Dashboard Content -->
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="admin-dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
                    <li><a href="admin-pelatihan.html"><i class="fas fa-book"></i> Pelatihan</a></li>
                    <li><a href="admin-lowongan.html" class="active"><i class="fas fa-briefcase"></i> Lowongan Kerja</a></li>
                    <li><a href="admin-pendaftar.html"><i class="fas fa-users"></i> Data Pendaftar</a></li>
                    <li><a href="admin-notifications.html"><i class="fas fa-bell"></i> Kelola Notifikasi</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-header-actions">
                <div>
                    <h1>Manajemen Lowongan Kerja</h1>
                    <p>Kelola data lowongan kerja</p>
                </div>
                <button class="btn btn-primary" id="addJobBtn">
                    <i class="fas fa-plus"></i> Tambah Lowongan
                </button>
            </div>

            <div class="search-container">
                <div class="search-input">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchJob" placeholder="Cari lowongan kerja...">
                </div>
            </div>

            <div class="data-table-container">
                <table class="data-table" id="jobTable">
                    <thead>
                        <tr>
                            <th>Posisi</th>
                            <th>Perusahaan</th>
                            <th>Jenis</th>
                            <th>Lokasi</th>
                            <th>Deadline</th>
                            <th>Status</th>
                            <th class="text-right">Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Job data will be loaded here via JavaScript -->
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <!-- Modal Tambah Lowongan Kerja -->
    <div id="modalTambahLowongan" class="modal">
        <div class="modal-content-job">
            <span class="close-modal">&times;</span>
            <h2>Tambah Lowongan Kerja</h2>
            <form id="formTambahLowongan">
                <input type="hidden" id="jobId">
                <div class="form-group">
                    <label for="lowonganPosisi">Posisi / Jabatan</label>
                    <input type="text" id="lowonganPosisi" placeholder="Contoh: Web Developer" required>
                </div>
                <div class="form-group">
                    <label for="lowonganPerusahaan">Nama Perusahaan</label>
                    <input type="text" id="lowonganPerusahaan" placeholder="Contoh: PT Teknologi Hebat" required>
                </div>
                <div class="form-group">
                    <label for="lowonganJenis">Jenis Pekerjaan</label>
                    <select id="lowonganJenis" required>
                        <option value="">-- Pilih Jenis --</option>
                        <option value="Full Time">Full Time</option>
                        <option value="Part Time">Part Time</option>
                        <option value="Freelance">Freelance</option>
                        <option value="Kontrak">Kontrak</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="lowonganLokasi">Lokasi</label>
                    <input type="text" id="lowonganLokasi" placeholder="Contoh: Jakarta, Surabaya, Remote" required>
                </div>
                <div class="form-group">
                    <label for="lowonganDeadline">Deadline</label>
                    <input type="date" id="lowonganDeadline" required>
                </div>
                <div class="form-group">
                    <label for="lowonganDeskripsi">Deskripsi Pekerjaan</label>
                    <textarea id="lowonganDeskripsi" rows="4" placeholder="Deskripsikan tanggung jawab dan kualifikasi yang dibutuhkan" required></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-outline" id="batalTambahLowongan">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Hapus Lowongan Kerja</h2>
            <p>Apakah Anda yakin ingin menghapus lowongan kerja ini? Tindakan ini tidak dapat dibatalkan.</p>
            <div class="modal-buttons">
                <button class="btn btn-outline" id="cancelDelete">Batal</button>
                <button class="btn btn-danger" id="confirmDelete">Hapus</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2025 KerjaAja. Hak Cipta Dilindungi.</p>
            </div>
        </div>
    </footer>

    <script src="js/data.js"></script>
    <script src="js/main.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/admin-notifications.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const jobTable = document.getElementById('jobTable').querySelector('tbody');
            const searchInput = document.getElementById('searchJob');
            const addJobBtn = document.getElementById('addJobBtn');
            const jobModal = document.getElementById('jobModal');
            const deleteModal = document.getElementById('deleteModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalDescription = document.getElementById('modalDescription');
            const jobForm = document.getElementById('jobForm');
            const jobIdInput = document.getElementById('jobId');
            const lowonganPosisi = document.getElementById('lowonganPosisi');
            const lowonganPerusahaan = document.getElementById('lowonganPerusahaan');
            const lowonganJenis = document.getElementById('lowonganJenis');
            const lowonganLokasi = document.getElementById('lowonganLokasi');
            const lowonganDeadline = document.getElementById('lowonganDeadline');
            const lowonganDeskripsi = document.getElementById('lowonganDeskripsi');
            
            let selectedJobId = null;
            
            // Display all jobs initially
            displayJobs(mockAdminJobs);
            
            // Search functionality
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const filteredJobs = mockAdminJobs.filter(job => 
                    job.title.toLowerCase().includes(searchTerm) || 
                    job.company.toLowerCase().includes(searchTerm) ||
                    job.location.toLowerCase().includes(searchTerm)
                );
                
                displayJobs(filteredJobs);
            });
            
            // Function to display jobs
            function displayJobs(jobs) {
                jobTable.innerHTML = '';
                
                if (jobs.length === 0) {
                    const emptyRow = document.createElement('tr');
                    emptyRow.innerHTML = `
                        <td colspan="7" class="text-center">Tidak ada lowongan kerja yang ditemukan</td>
                    `;
                    jobTable.appendChild(emptyRow);
                } else {
                    jobs.forEach(job => {
                        const row = document.createElement('tr');
                        
                        let statusClass = '';
                        let statusText = '';
                        
                        switch (job.status) {
                            case 'active':
                                statusClass = 'status-accepted';
                                statusText = 'Aktif';
                                break;
                            case 'closed':
                                statusClass = 'status-completed';
                                statusText = 'Ditutup';
                                break;
                            case 'filled':
                                statusClass = 'status-pending';
                                statusText = 'Terisi';
                                break;
                        }
                        
                        row.innerHTML = `
                            <td>${job.title}</td>
                            <td>${job.company}</td>
                            <td>${job.type}</td>
                            <td>${job.location}</td>
                            <td>${job.deadline}</td>
                            <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                            <td class="text-right">
                                <div class="action-buttons">
                                    <button class="btn-icon edit-btn" data-id="${job.id}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-icon delete-btn" data-id="${job.id}">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        `;
                        
                        jobTable.appendChild(row);
                    });
                    
                    // Add event listeners to action buttons
                    document.querySelectorAll('.edit-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            const jobId = this.getAttribute('data-id');
                            openEditModal(jobId);
                        });
                    });
                    
                    document.querySelectorAll('.delete-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            selectedJobId = this.getAttribute('data-id');
                            deleteModal.style.display = 'block';
                        });
                    });
                }
            }
            
            // Open add job modal
            addJobBtn.addEventListener('click', function() {
                modalTitle.textContent = 'Tambah Lowongan Kerja Baru';
                modalDescription.textContent = 'Isi form berikut untuk menambahkan lowongan kerja baru';
                jobForm.reset();
                jobIdInput.value = '';
                jobModal.style.display = 'block';
            });
            
            // Open edit job modal
            function openEditModal(jobId) {
                const job = mockAdminJobs.find(j => j.id == jobId);
                
                if (job) {
                    modalTitle.textContent = 'Edit Lowongan Kerja';
                    modalDescription.textContent = 'Edit informasi lowongan kerja';
                    
                    jobIdInput.value = job.id;
                    titleInput.value = job.title;
                    companyInput.value = job.company;
                    typeInput.value = job.type;
                    locationInput.value = job.location;
                    deadlineInput.value = job.deadline;
                    descriptionInput.value = job.description;
                    
                    jobModal.style.display = 'block';
                }
            }
            
            // Handle form submission
            jobForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Validate form
                if (!titleInput.value || !companyInput.value || !locationInput.value || !deadlineInput.value || !descriptionInput.value) {
                    alert('Semua field harus diisi');
                    return;
                }
                
                // In a real app, this would send data to a server
                if (jobIdInput.value) {
                    // Editing existing job
                    alert('Lowongan kerja berhasil diperbarui!');
                } else {
                    // Adding new job
                    alert('Lowongan kerja baru berhasil ditambahkan!');
                }
                
                jobModal.style.display = 'none';
            });
            
            // Handle delete confirmation
            document.getElementById('confirmDelete').addEventListener('click', function() {
                // In a real app, this would send a delete request to a server
                alert('Lowongan kerja berhasil dihapus!');
                deleteModal.style.display = 'none';
            });
            
            // Close modals
            document.querySelectorAll('.close-modal').forEach(closeBtn => {
                closeBtn.addEventListener('click', function() {
                    jobModal.style.display = 'none';
                    deleteModal.style.display = 'none';
                });
            });
            
            document.getElementById('batalTambahLowongan').addEventListener('click', function() {
                jobModal.style.display = 'none';
            });
            
            document.getElementById('cancelDelete').addEventListener('click', function() {
                deleteModal.style.display = 'none';
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === jobModal) {
                    jobModal.style.display = 'none';
                }
                if (event.target === deleteModal) {
                    deleteModal.style.display = 'none';
                }
            });
            
            // Setup logout button
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = 'login.html';
            });
        });
    </script>
</body>
</html>