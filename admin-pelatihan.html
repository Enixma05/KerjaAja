<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manajemen Pelatihan - KerjaAja</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/notifications.css">
    <link rel="stylesheet" href="css/admin-notifications.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="logo">
                <a href="admin-dashboard.html">KerjaAja Admin</a>
            </div>
            <nav class="nav">
                <ul>
                    <!-- Admin Notifications -->
                    <li class="notification-dropdown">
                        <div class="notification-menu" id="adminNotificationMenu">
                            <div class="notification-header">
                                <h4>Notifikasi Admin</h4>
                                <button class="mark-all-read" id="adminMarkAllRead">
                                    <i class="fas fa-check-double"></i>
                                    Tandai Semua Dibaca
                                </button>
                            </div>
                            <div class="notification-list" id="adminNotificationList">
                                <!-- Admin notifications will be populated by JavaScript -->
                            </div>
                            <div class="notification-footer">
                                <a href="admin-notifications.html" id="viewAllAdminNotifications">Lihat Semua Notifikasi</a>
                            </div>
                        </div>
                    </li>
                    <!-- Send Notification Button -->
                    <li>
                        <button class="btn btn-primary" id="sendNotificationBtn">
                            <i class="fas fa-paper-plane"></i> Kirim Notifikasi
                        </button>
                    </li>
                    <li><a href="#" id="logoutBtn" class="btn-logout">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Notification Toast Container -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- Send Notification Modal -->
    <div id="sendNotificationModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" id="closeSendModal">&times;</span>
            <h2>Kirim Notifikasi</h2>
            <p>Kirim notifikasi ke pengguna platform</p>
            
            <form id="sendNotificationForm">
                <div class="form-group">
                    <label for="notificationType">Jenis Notifikasi</label>
                    <select id="notificationType" required>
                        <option value="">Pilih Jenis</option>
                        <option value="info">Informasi</option>
                        <option value="success">Berhasil</option>
                        <option value="warning">Peringatan</option>
                        <option value="error">Error</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="notificationTarget">Target Penerima</label>
                    <select id="notificationTarget" required>
                        <option value="">Pilih Target</option>
                        <option value="all">Semua Pengguna</option>
                        <option value="active">Pengguna Aktif</option>
                        <option value="training">Peserta Pelatihan</option>
                        <option value="job_seekers">Pencari Kerja</option>
                        <option value="specific">Pengguna Tertentu</option>
                    </select>
                </div>

                <div class="form-group" id="specificUsersGroup" style="display: none;">
                    <label for="specificUsers">Email Pengguna (pisahkan dengan koma)</label>
                    <textarea id="specificUsers" rows="3" placeholder="user1@email.com, user2@email.com"></textarea>
                </div>

                <div class="form-group">
                    <label for="notificationTitle">Judul Notifikasi</label>
                    <input type="text" id="notificationTitle" required placeholder="Masukkan judul notifikasi">
                </div>

                <div class="form-group">
                    <label for="notificationMessage">Pesan</label>
                    <textarea id="notificationMessage" rows="4" required placeholder="Masukkan pesan notifikasi"></textarea>
                </div>

                <div class="form-group">
                    <label for="notificationAction">Action URL (opsional)</label>
                    <input type="url" id="notificationAction" placeholder="https://example.com">
                </div>

                <div class="form-group">
                    <label for="scheduleNotification">
                        <input type="checkbox" id="scheduleNotification"> Jadwalkan Notifikasi
                    </label>
                </div>

                <div class="form-group" id="scheduleGroup" style="display: none;">
                    <label for="scheduleDateTime">Tanggal & Waktu</label>
                    <input type="datetime-local" id="scheduleDateTime">
                </div>

                <div class="modal-buttons">
                    <button type="button" id="cancelSendNotification" class="btn btn-outline">Batal</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-paper-plane"></i> Kirim Notifikasi
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Dashboard Content -->
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="admin-dashboard.html"><i class="fas fa-home"></i> Dashboard</a></li>
                    <li><a href="admin-pelatihan.html" class="active"><i class="fas fa-book"></i> Pelatihan</a></li>
                    <li><a href="admin-lowongan.html"><i class="fas fa-briefcase"></i> Lowongan Kerja</a></li>
                    <li><a href="admin-pendaftar.html"><i class="fas fa-users"></i> Data Pendaftar</a></li>
                    <li><a href="admin-notifications.html"><i class="fas fa-bell"></i> Kelola Notifikasi</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="page-header-actions">
                <div>
                    <h1>Manajemen Pelatihan</h1>
                    <p>Kelola data pelatihan</p>
                </div>
                <button class="btn btn-primary" id="addTrainingBtn">
                    <i class="fas fa-plus"></i> Tambah Pelatihan
                </button>
            </div>

            <div class="search-container">
                <div class="search-input">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchTraining" placeholder="Cari pelatihan...">
                </div>
            </div>

            <div class="data-table-container">
                <table class="data-table" id="trainingTable">
                    <thead>
                        <tr>
                            <th>Nama Pelatihan</th>
                            <th>Tanggal</th>
                            <th>Lokasi</th>
                            <th>Kuota</th>
                            <th>Status</th>
                            <th class="text-right">Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Training data will be loaded here via JavaScript -->
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <!-- Add/Edit Training Modal -->
    <div id="trainingModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="modalTitle">Tambah Pelatihan Baru</h2>
            <p id="modalDescription">Isi form berikut untuk menambahkan pelatihan baru</p>
            <form id="trainingForm">
                <input type="hidden" id="trainingId">
                <div class="form-group">
                    <label for="name">Nama Pelatihan</label>
                    <input type="text" id="name" placeholder="Nama pelatihan" required>
                </div>
                <div class="form-group">
                    <label for="date">Tanggal</label>
                    <div class="input-icon">
                        <i class="fas fa-calendar"></i>
                        <input type="text" id="date" placeholder="DD/MM/YYYY" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="location">Lokasi</label>
                    <input type="text" id="location" placeholder="Lokasi pelatihan" required>
                </div>
                <div class="form-group">
                    <label for="quota">Kuota</label>
                    <input type="number" id="quota" placeholder="Jumlah kuota" required>
                </div>
                <div class="form-group">
                    <label for="description">Deskripsi</label>
                    <textarea id="description" placeholder="Deskripsi pelatihan" rows="4" required></textarea>
                </div>
                <div class="modal-buttons">
                    <button type="button" class="btn btn-outline" id="cancelTraining">Batal</button>
                    <button type="submit" class="btn btn-primary">Simpan</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>Hapus Pelatihan</h2>
            <p>Apakah Anda yakin ingin menghapus pelatihan ini? Tindakan ini tidak dapat dibatalkan.</p>
            <div class="modal-buttons">
                <button class="btn btn-outline" id="cancelDelete">Batal</button>
                <button class="btn btn-danger" id="confirmDelete">Hapus</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-bottom">
                <p>&copy; 2025 KerjaAja. Hak Cipta Dilindungi.</p>
            </div>
        </div>
    </footer>

    <script src="js/data.js"></script>
    <script src="js/main.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/admin-notifications.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const trainingTable = document.getElementById('trainingTable').querySelector('tbody');
            const searchInput = document.getElementById('searchTraining');
            const addTrainingBtn = document.getElementById('addTrainingBtn');
            const trainingModal = document.getElementById('trainingModal');
            const deleteModal = document.getElementById('deleteModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalDescription = document.getElementById('modalDescription');
            const trainingForm = document.getElementById('trainingForm');
            const trainingIdInput = document.getElementById('trainingId');
            const nameInput = document.getElementById('name');
            const dateInput = document.getElementById('date');
            const locationInput = document.getElementById('location');
            const quotaInput = document.getElementById('quota');
            const descriptionInput = document.getElementById('description');
            
            let selectedTrainingId = null;
            
            // Display all trainings initially
            displayTrainings(mockAdminTrainings);
            
            // Search functionality
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                const filteredTrainings = mockAdminTrainings.filter(training => 
                    training.name.toLowerCase().includes(searchTerm) || 
                    training.location.toLowerCase().includes(searchTerm)
                );
                
                displayTrainings(filteredTrainings);
            });
            
            // Function to display trainings
            function displayTrainings(trainings) {
                trainingTable.innerHTML = '';
                
                if (trainings.length === 0) {
                    const emptyRow = document.createElement('tr');
                    emptyRow.innerHTML = `
                        <td colspan="6" class="text-center">Tidak ada pelatihan yang ditemukan</td>
                    `;
                    trainingTable.appendChild(emptyRow);
                } else {
                    trainings.forEach(training => {
                        const row = document.createElement('tr');
                        
                        let statusClass = '';
                        let statusText = '';
                        
                        switch (training.status) {
                            case 'upcoming':
                                statusClass = 'status-pending';
                                statusText = 'Akan Datang';
                                break;
                            case 'active':
                                statusClass = 'status-accepted';
                                statusText = 'Aktif';
                                break;
                            case 'completed':
                                statusClass = 'status-completed';
                                statusText = 'Selesai';
                                break;
                            case 'cancelled':
                                statusClass = 'status-rejected';
                                statusText = 'Dibatalkan';
                                break;
                        }
                        
                        row.innerHTML = `
                            <td>${training.name}</td>
                            <td>${training.date}</td>
                            <td>${training.location}</td>
                            <td>${training.quota}</td>
                            <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                            <td class="text-right">
                                <div class="action-buttons">
                                    <button class="btn-icon edit-btn" data-id="${training.id}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-icon delete-btn" data-id="${training.id}">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        `;
                        
                        trainingTable.appendChild(row);
                    });
                    
                    // Add event listeners to action buttons
                    document.querySelectorAll('.edit-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            const trainingId = this.getAttribute('data-id');
                            openEditModal(trainingId);
                        });
                    });
                    
                    document.querySelectorAll('.delete-btn').forEach(button => {
                        button.addEventListener('click', function() {
                            selectedTrainingId = this.getAttribute('data-id');
                            deleteModal.style.display = 'block';
                        });
                    });
                }
            }
            
            // Open add training modal
            addTrainingBtn.addEventListener('click', function() {
                modalTitle.textContent = 'Tambah Pelatihan Baru';
                modalDescription.textContent = 'Isi form berikut untuk menambahkan pelatihan baru';
                trainingForm.reset();
                trainingIdInput.value = '';
                trainingModal.style.display = 'block';
            });
            
            // Open edit training modal
            function openEditModal(trainingId) {
                const training = mockAdminTrainings.find(t => t.id == trainingId);
                
                if (training) {
                    modalTitle.textContent = 'Edit Pelatihan';
                    modalDescription.textContent = 'Edit informasi pelatihan';
                    
                    trainingIdInput.value = training.id;
                    nameInput.value = training.name;
                    dateInput.value = training.date;
                    locationInput.value = training.location;
                    quotaInput.value = training.quota;
                    descriptionInput.value = training.description;
                    
                    trainingModal.style.display = 'block';
                }
            }
            
            // Handle form submission
            trainingForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // Validate form
                if (!nameInput.value || !dateInput.value || !locationInput.value || !quotaInput.value || !descriptionInput.value) {
                    alert('Semua field harus diisi');
                    return;
                }
                
                // In a real app, this would send data to a server
                if (trainingIdInput.value) {
                    // Editing existing training
                    alert('Pelatihan berhasil diperbarui!');
                } else {
                    // Adding new training
                    alert('Pelatihan baru berhasil ditambahkan!');
                }
                
                trainingModal.style.display = 'none';
            });
            
            // Handle delete confirmation
            document.getElementById('confirmDelete').addEventListener('click', function() {
                // In a real app, this would send a delete request to a server
                alert('Pelatihan berhasil dihapus!');
                deleteModal.style.display = 'none';
            });
            
            // Close modals
            document.querySelectorAll('.close-modal').forEach(closeBtn => {
                closeBtn.addEventListener('click', function() {
                    trainingModal.style.display = 'none';
                    deleteModal.style.display = 'none';
                });
            });
            
            document.getElementById('cancelTraining').addEventListener('click', function() {
                trainingModal.style.display = 'none';
            });
            
            document.getElementById('cancelDelete').addEventListener('click', function() {
                deleteModal.style.display = 'none';
            });
            
            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === trainingModal) {
                    trainingModal.style.display = 'none';
                }
                if (event.target === deleteModal) {
                    deleteModal.style.display = 'none';
                }
            });
            
            // Setup logout button
            document.getElementById('logoutBtn').addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = 'login.html';
            });
        });
    </script>
</body>
</html>